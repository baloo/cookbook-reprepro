# This file is generated by chef
# Any changes here will be overriden on next run

server {
  server_name <%= @fqdn %> <%= @apt_repo_name %>.<%= node[:reprepro][:fqdn] %> <%= node[:reprepro][:fqdn] %> <%= node[:hostname] %> <%= node[:fqdn] %>;
  root <%= @repo_dir %>;
  location / {
    autoindex  on;

    <% if @access %>
    # Handle access control
    <% @access.each{|access| %>
    allow <%= access[:block] %>; # <%= access[:name] %>
    <% } %>
    deny    all;
    <% end %>
  }
  location /conf {
    deny all;
  }
  access_log /var/log/nginx/apt_repo-<%= @apt_repo_name %>-access.log;
  error_log /var/log/nginx/apt_repo-<%= @apt_repo_name %>-error.log;
}

